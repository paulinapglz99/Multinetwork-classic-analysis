---
title: "Network analysis report"
output: html_document
---

```{r, echo=FALSE}
library(data.table); library(ggplot2); library(ggpubr)
summary <- fread('/datos/home/paulinapg/Multinetwork-classic-analysis/results/networks_summary.csv')
print(head(summary))
#Plot

#Plot --- ---

#Plot number of vertices 

v_plot <- summary %>%
  ggplot(aes(x = as.factor(network), y = n_nodes,  group = 1)) +
    geom_line() +
    geom_point(aes(color = "cornflowerblue"), size = 2)+
  labs(title = "Number of vertices (genes)",
       x = "Networks",
       y = "Number of vertices") 
  theme_pubclean() +
  theme(legend.position = "none") +
  scale_y_continuous(limits = c(50, max(summary$n_nodes))) 
  
#Plot number of edges 

E_plot <- ggplot(summary, aes(x = as.factor(network), y = n_edges)) +
  geom_linerange(
    aes(x =  as.factor(network), ymin = 0, ymax = n_edges), 
    color = "lightgray", size = 1.5
    )+
  geom_point(aes(color = network), size = 2)+
   labs(title = "Number of edges",
       x = "Percentile",
       y = "Number of edges") +
  ggpubr::color_palette("jco") +
  theme_pubclean()

#Plot number of components

components_plot <- ggplot(summary, aes(x = as.factor(network), y = n_components)) +
  geom_linerange(
    aes(x =  as.factor(network), ymin = 0, ymax = n_components), 
    color = "lightgray", size = 1.5
    )+
  geom_point(aes(color = network), size = 2)+
     labs(title = "Number of components",
       x = "Percentile",
       y = "Number of components") +
  ggpubr::color_palette("jco") +
  theme_pubclean()

#Plot number of clusters with INFOMAP

components_INFOMAP_plot <- ggplot(metrics, aes(x = percentile, y = no_cluster_infomap, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_color_brewer(palette = "Set1") +  # You can choose different palettes
  labs(title = "Number of clusters (Infomap)",
       x = "Percentile",
       y = "Number of clusters") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

#Plot clustering coefficient

clusteringcoe_plot <- ggplot(metrics, aes(x = percentile, y = clustering_coefficient, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_color_brewer(palette = "Set1") + # You can choose different palettes
  labs(title = "Clustering coefficient",
       x = "Percentile",
       y = "Clustering coefficient ") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

#Plot max weight

max_weight_plot <- ggplot(metrics, aes(x = percentile, y = max_MI, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_color_brewer(palette = "Set1") +  # You can choose different palettes
  labs(title = "Maximal weight",
       x = "Percentile",
       y = "Max weight") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

#Plot min weight

min_weight_plot <- ggplot(metrics, aes(x = percentile, y = min_MI, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_color_brewer(palette = "Set1") +   # You can choose different palettes
  labs(title = "Minimal weight",
       x = "Percentile",
       y = "Min weight") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

#Plot max comp size

max_comp_size_plot <- ggplot(metrics, aes(x = percentile, y = max_comp_size, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_color_brewer(palette = "Set1") +  # You can choose different palettes
  labs(title = "Maximal component size",
       x = "Percentile",
       y = "Larger component size") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

#Plot percentage of genes in the max size comp

per_genes_max_size_plot <- ggplot(metrics, aes(x = percentile, y = percentage_genes_in_larger_component, color = dx)) +
  geom_point(size = 3) +
  geom_line(aes(group = dx), size = 1) +
  scale_y_continuous(limits = c(min(metrics$percentage_genes_in_larger_component), 100), breaks = seq(50, 100, by = 20)) +
  scale_color_brewer(palette = "Set1") +  # You can choose different palettes
  labs(title = "% of genes in larger component",
       x = "Percentile",
       y = "% of genes in larger component") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.text.x = element_text(angle = 45, hjust = 1))

```
